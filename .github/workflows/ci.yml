
name: ANGULAR-ACTIONS

on:
  push:
    branches: [ "master" ]
    
  workflow_dispatch:
  
jobs:

#   test:
#     runs-on: ubuntu-latest
#     defaults:
#       run:
#         working-directory: angular/
#     steps:
#         - name: Checkout
#           uses: actions/checkout@v2      
#         - name: Setup-node     
#           uses: actions/setup-node@v2
#           with:
#             node-version: 14.x                  
#         - name: Install
#           run: npm ci
#         - name: Run Test
#           run: npm run test -- --no-watch --no-progress --browsers=ChromeHeadless
#         - name: Send notification
#           uses: dawidd6/action-send-mail@v2
#           with:
#             server_address: smtp.gmail.com
#             server_port: 587
#             username: ${{ secrets.EMAIL_USERNAME }}
#             password: ${{ secrets.EMAIL_PASSWORD }}
#             subject: ${{ github.job }} job of ${{ github.repository }} has ${{ job.status }}
#             body: ${{ github.job }} job in workflow ${{ github.workflow }} of ${{ github.repository }} has ${{ job.status }} 
#             to: djsasha777@mail.ru
#             from: Alex xxx

#   build:
#     runs-on: ubuntu-latest
#     permissions:
#       contents: read
#       packages: write
#     needs: [test]
#     steps:
#         - name: Checkout
#           uses: actions/checkout@v2  
#         - name: Setup-node     
#           uses: actions/setup-node@v2
#           with:
#             node-version: 14.x        
#             working-directory: angular/          
#         - name: Install
#           working-directory: angular/
#           run: npm ci
#         - name: Run build
#           working-directory: angular/
#           run: npm run build       
#         - name: Login to github registry
#           uses: docker/login-action@v2
#           with:
#             registry: ghcr.io
#             username: ${{ github.actor }}
#             password: ${{ secrets.GITHUB_TOKEN }}
#         - name : build docker image and push
#           uses: docker/build-push-action@v3
#           with:
#             context: .
#             file: ./Dockerfile
#             push: true
#             tags: |
#               ghcr.io/${{ github.repository }}/angular:1

# # If you want to push to dokerhub              
#         # - name: Login to DockerHub
#         #   uses: docker/login-action@v2
#         #   with:
#         #     username: ${{ secrets.DOCKERHUB_USERNAME }}
#         #     password: ${{ secrets.DOCKERHUB_PASSWORD }}
#         # -
#         #   name: Build and push
#         #   uses: docker/build-push-action@v3
#         #   with:
#         #     context: .
#         #     push: true
#         #     tags: djsasha777/ang:1
        
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    # needs: [build]
    steps:
        - name: Checkout
          uses: actions/checkout@v2  
        - name: Setup-node     
          run: echo "deploy will be here"
        - name: Send notification
          uses: dawidd6/action-send-mail@v2
          with:
            server_address: smtp.gmail.com
            server_port: 587
            username: ${{ secrets.EMAIL_USERNAME }}
            password: ${{ secrets.EMAIL_PASSWORD }}
            subject: ${{ github.job }} job of ${{ github.repository }} has ${{ job.status }}
            body: ${{ github.job }} job in workflow ${{ github.workflow }} of ${{ github.repository }} has ${{ job.status }} 
            to: djsasha777@mail.ru
            from: Alex xxx